# ============================================================================
# Indian Market Web Dashboard - Environment Configuration
# ============================================================================
#
# IMPORTANT: Copy this file to .env and update with your actual values
#
# Quick Setup:
#   1. Copy this file: cp .env.example .env
#   2. Generate secure keys (see commands below)
#   3. Update FLASK_SECRET_KEY and ENCRYPTION_KEY
#   4. Adjust other settings as needed
#   5. Save and restart the dashboard
#
# ============================================================================

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

# Host to bind the dashboard to
# - 127.0.0.1: Localhost only (recommended for local development)
# - 0.0.0.0: All network interfaces (use with caution, requires firewall)
# Default: 127.0.0.1
DASHBOARD_HOST=127.0.0.1

# Port to run the dashboard on
# - Common ports: 8080, 8000, 5000
# - Ensure the port is not already in use
# - Ports below 1024 require root/admin privileges
# Default: 8080
DASHBOARD_PORT=8080

# Enable debug mode
# - True: Detailed error messages, auto-reload on code changes
# - False: Production mode with minimal error details
# WARNING: NEVER use True in production! Debug mode exposes sensitive information
# Default: False
DASHBOARD_DEBUG=False

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================
# 
# CRITICAL: These keys MUST be changed before deploying to production!
# Using default or weak keys compromises the security of your credentials
# and session data.
#
# ============================================================================

# Flask secret key for session management and CSRF protection
# - Used to sign session cookies and secure forms
# - Must be a long, random, and secret string
# - Changing this key will invalidate all existing sessions
# 
# Generate a secure key with:
#   python -c "import secrets; print(secrets.token_hex(32))"
#
# Example output: a1b2c3d4e5f6...
# Default: your-random-secret-key-here-change-this-in-production (INSECURE!)
FLASK_SECRET_KEY=your-random-secret-key-here-change-this-in-production

# Encryption key for storing broker credentials
# - Used to encrypt API keys, secrets, and passwords before storing
# - Must be a valid Fernet key (44 characters, base64-encoded)
# - Changing this key will make existing encrypted credentials unreadable
# - BACKUP this key securely - losing it means losing access to credentials
#
# Generate a secure encryption key with:
#   python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#
# Example output: abcdefghijklmnopqrstuvwxyz0123456789ABCD=
# Default: your-encryption-key-here-change-this-in-production (INSECURE!)
ENCRYPTION_KEY=your-encryption-key-here-change-this-in-production

# ============================================================================
# SESSION CONFIGURATION
# ============================================================================

# Session timeout in seconds
# - How long a user session remains active without activity
# - After timeout, users must reconnect to their broker
# - Common values: 1800 (30 min), 3600 (1 hour), 7200 (2 hours)
# - Shorter timeouts are more secure but less convenient
# Default: 3600 (1 hour)
SESSION_TIMEOUT=3600

# ============================================================================
# DASHBOARD SETTINGS
# ============================================================================

# Auto-refresh interval for monitoring tab (seconds)
# - How often the dashboard updates positions, account info, and bot status
# - Lower values provide more real-time updates but increase API calls
# - Higher values reduce API load but updates are less frequent
# - Recommended range: 3-10 seconds
# Default: 5 seconds
AUTO_REFRESH_INTERVAL=5

# Instrument cache time-to-live (seconds)
# - How long to cache the list of instruments from broker
# - Instruments don't change frequently, so longer cache is acceptable
# - Set to 0 to disable caching (not recommended)
# - Common values: 43200 (12 hours), 86400 (24 hours), 604800 (7 days)
# Default: 86400 (24 hours)
INSTRUMENT_CACHE_TTL=86400

# ============================================================================
# RATE LIMITING
# ============================================================================
#
# Rate limiting protects against excessive API calls and potential abuse
# Adjust these settings based on your broker's API limits
#
# ============================================================================

# Enable rate limiting
# - True: Enforce rate limits on API endpoints
# - False: Disable rate limiting (not recommended)
# Default: True
RATE_LIMIT_ENABLED=True

# Maximum requests per minute per endpoint
# - Limits how many requests can be made to each API endpoint per minute
# - Prevents accidental API abuse and broker rate limit violations
# - Adjust based on your broker's limits (typically 60-180 requests/min)
# - Set higher for development, lower for production
# Default: 60 requests/minute
RATE_LIMIT_PER_MINUTE=60

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log level
# - DEBUG: Detailed information for debugging (verbose)
# - INFO: General informational messages (recommended for production)
# - WARNING: Warning messages for potential issues
# - ERROR: Error messages only
# - CRITICAL: Critical errors only
# 
# Use DEBUG for development, INFO or WARNING for production
# Default: INFO
LOG_LEVEL=INFO

# ============================================================================
# BROKER CONFIGURATION (Optional)
# ============================================================================
#
# These settings are optional and can be configured through the UI
# Uncomment and set if you want to pre-configure a default broker
#
# ============================================================================

# Default broker to use on startup
# - Options: kite, alice_blue, angel_one, upstox, paper
# - If set, the dashboard will pre-select this broker
# - Users can still change the broker in the UI
# - Useful for single-broker deployments
# Default: None (user selects in UI)
# DEFAULT_BROKER=paper

# ============================================================================
# ADVANCED CONFIGURATION (Optional)
# ============================================================================
#
# These settings are for advanced users and specific deployment scenarios
# Most users can leave these commented out to use defaults
#
# ============================================================================

# Custom data directory for cache and credentials
# - Override the default data directory location
# - Useful for custom deployment paths or shared storage
# Default: ./data (relative to dashboard directory)
# DATA_DIR=/path/to/custom/data

# Custom configuration directory
# - Override the default configs directory location
# - Useful for centralized configuration management
# Default: ./configs (relative to dashboard directory)
# CONFIG_DIR=/path/to/custom/configs

# Custom log directory
# - Override the default logs directory location
# - Useful for centralized log management
# Default: ./logs (relative to dashboard directory)
# LOG_DIR=/path/to/custom/logs

# Maximum log file size in bytes
# - When log file exceeds this size, it will be rotated
# - Set to 0 to disable size-based rotation
# Default: 10485760 (10 MB)
# MAX_LOG_SIZE=10485760

# Number of backup log files to keep
# - How many rotated log files to retain
# - Older files are automatically deleted
# Default: 5
# LOG_BACKUP_COUNT=5

# Enable CORS (Cross-Origin Resource Sharing)
# - Allow dashboard API access from different origins
# - Only enable if you need to access the API from external applications
# - Security risk if enabled without proper origin restrictions
# Default: False
# ENABLE_CORS=False

# Allowed CORS origins (comma-separated)
# - List of origins allowed to access the API
# - Only used if ENABLE_CORS=True
# - Use * to allow all origins (NOT recommended for production)
# Example: http://localhost:3000,https://example.com
# CORS_ORIGINS=http://localhost:3000

# ============================================================================
# SECURITY BEST PRACTICES
# ============================================================================
#
# 1. FILE PERMISSIONS
#    - Restrict access to .env file:
#      Linux/macOS: chmod 600 .env
#      Windows: Right-click → Properties → Security → Edit permissions
#
# 2. VERSION CONTROL
#    - NEVER commit .env file to Git or any version control
#    - Ensure .env is in .gitignore
#    - Only commit .env.example with placeholder values
#
# 3. KEY MANAGEMENT
#    - Generate unique keys for each environment (dev, staging, production)
#    - Store production keys in a secure password manager
#    - Rotate keys every 90 days or after suspected compromise
#    - Never share keys via email, chat, or insecure channels
#
# 4. ENCRYPTION KEY BACKUP
#    - Backup ENCRYPTION_KEY securely - losing it means losing credentials
#    - Store backup in a different location than the application
#    - Consider using a key management service for production
#
# 5. NETWORK SECURITY
#    - Use DASHBOARD_HOST=127.0.0.1 unless network access is required
#    - If using 0.0.0.0, configure firewall rules to restrict access
#    - Use HTTPS/SSL in production (reverse proxy with nginx/apache)
#    - Enable IP whitelisting if your broker supports it
#
# 6. PRODUCTION DEPLOYMENT
#    - Set DASHBOARD_DEBUG=False in production
#    - Use strong, randomly generated keys (not example values)
#    - Enable rate limiting (RATE_LIMIT_ENABLED=True)
#    - Use INFO or WARNING log level (not DEBUG)
#    - Run dashboard as non-root user with minimal permissions
#    - Keep dependencies updated (pip install --upgrade -r requirements.txt)
#
# 7. MONITORING AND AUDITING
#    - Regularly review logs for suspicious activity
#    - Monitor failed login attempts
#    - Set up alerts for critical errors
#    - Backup credentials and configurations regularly
#
# 8. BROKER API SECURITY
#    - Use separate API keys for testing and production
#    - Enable 2FA on your broker account
#    - Monitor API usage in broker dashboard
#    - Revoke and regenerate keys if compromised
#    - Never share API keys or credentials
#
# 9. ENVIRONMENT VARIABLES (Alternative to .env file)
#    - For production, consider using system environment variables
#    - More secure than .env file in shared hosting environments
#    - Set via: export VAR=value (Linux/macOS) or set VAR=value (Windows)
#    - Or use container orchestration secrets (Docker, Kubernetes)
#
# 10. REGULAR MAINTENANCE
#     - Update dependencies monthly: pip install --upgrade -r requirements.txt
#     - Check for security vulnerabilities: pip install safety && safety check
#     - Rotate keys quarterly
#     - Review and update firewall rules
#     - Test backup and recovery procedures
#
# ============================================================================
# TROUBLESHOOTING
# ============================================================================
#
# Issue: "Invalid encryption key" error
# Solution: Ensure ENCRYPTION_KEY is a valid Fernet key (44 chars, base64)
#           Generate new key with the command above
#
# Issue: "Session expired" messages
# Solution: Increase SESSION_TIMEOUT value or reconnect to broker
#
# Issue: "Rate limit exceeded" errors
# Solution: Increase RATE_LIMIT_PER_MINUTE or reduce API call frequency
#
# Issue: Dashboard not accessible from network
# Solution: Change DASHBOARD_HOST to 0.0.0.0 and configure firewall
#
# Issue: Port already in use
# Solution: Change DASHBOARD_PORT to an available port (e.g., 8081, 8000)
#
# Issue: Credentials not persisting after restart
# Solution: Verify ENCRYPTION_KEY hasn't changed and data directory exists
#
# For more help, see TROUBLESHOOTING_REFERENCE.md
#
# ============================================================================
# ADDITIONAL RESOURCES
# ============================================================================
#
# Documentation:
#   - User Guide: USER_GUIDE.md
#   - Deployment Guide: DEPLOYMENT_GUIDE.md
#   - Configuration Guide: CONFIGURATION_GUIDE.md
#   - Troubleshooting: TROUBLESHOOTING_REFERENCE.md
#
# Support:
#   - Check logs: logs/dashboard.log
#   - Review FAQ: FAQ.md
#   - Broker API docs: https://kite.trade/docs/connect/v3/
#
# ============================================================================
# END OF CONFIGURATION
# ============================================================================
#
# Remember to:
#   1. Copy this file to .env
#   2. Generate and set secure keys
#   3. Adjust settings for your environment
#   4. Restart dashboard after changes
#   5. Keep this file secure and never commit to version control
#
# ============================================================================
