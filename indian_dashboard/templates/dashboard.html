<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEM Trading Bot - ‚Çπ</title>

    <!-- CRITICAL: Strategy Recommendations Script - Load FIRST -->
    <script>
        window.STRATEGY_REC_DEBUG = true;
        console.log('%c=== STRATEGY RECOMMENDATIONS SCRIPT LOADING (HEAD) ===', 'background: #FCD535; color: #000; font-size: 16px; font-weight: bold; padding: 5px;');
    </script>

    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link rel="stylesheet" href="/static/css/error-handler.css">
    <link rel="stylesheet" href="/static/css/loading-states.css">
    <link rel="stylesheet" href="/static/css/ui-enhancements.css">
    <link rel="stylesheet" href="/static/css/helpful-features.css">
    <link rel="stylesheet" href="/static/css/strategy-recommendations.css">
    <link rel="stylesheet" href="/static/css/activity-log.css">
    <link rel="stylesheet" href="/static/css/analytics.css">
    <link rel="stylesheet" href="/static/css/charts.css">
    <link rel="stylesheet" href="/static/css/logs.css">
    <link rel="stylesheet" href="/static/css/gem-theme.css">
    <link rel="stylesheet" href="/static/css/backtest.css">

    <!-- Inline critical styles for tips box and instrument tags to override cache -->
    <style>
        /* Tips/Alert Box - BLACK text on existing yellow background */
        .alert-info,
        div.alert-info,
        .alert.alert-info,
        [class*="alert"][class*="info"] {
            background: #FFF3CD !important;
            color: #000000 !important;
            border: 1px solid #FCD535 !important;
            border-left: 4px solid #FCD535 !important;
        }

        .alert-info *,
        div.alert-info *,
        .alert.alert-info *,
        [class*="alert"][class*="info"] * {
            color: #000000 !important;
        }

        /* Selected Instrument Tags - BLACK background with WHITE text */
        .selected-instrument-tag,
        #selected-instruments .selected-instrument-tag,
        #config-selected-instruments .selected-instrument-tag,
        .instrument-chip,
        .instrument-tag {
            background: #000000 !important;
            border: 1px solid #FCD535 !important;
            color: #FFFFFF !important;
        }

        .selected-instrument-tag *,
        .instrument-chip *,
        .instrument-tag * {
            color: #FFFFFF !important;
        }

        .selected-instrument-tag .instrument-symbol,
        .selected-instrument-tag .instrument-info .instrument-symbol,
        .instrument-chip .symbol {
            color: #FFFFFF !important;
            font-weight: 600 !important;
        }

        .selected-instrument-tag .instrument-exchange,
        .selected-instrument-tag .instrument-info .instrument-exchange,
        .instrument-chip .exchange {
            color: #FCD535 !important;
            font-weight: 500 !important;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="container">
            <h1 class="logo">
                <span class="gem-icon">üíé</span>
                GEM Trading Bot
                <span class="rupee-symbol">‚Çπ</span>
            </h1>
            <div class="header-status">
                <span id="broker-status" class="status-badge">Not Connected</span>
                <span id="bot-status" class="status-badge">Stopped</span>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="tab-navigation">
        <div class="container">
            <button class="tab-button active" data-tab="broker">Broker</button>
            <button class="tab-button" data-tab="instruments">Instruments</button>
            <button class="tab-button" data-tab="configuration">Configuration</button>
            <button class="tab-button" data-tab="monitor">Monitor</button>
            <button class="tab-button" data-tab="trades">Trades</button>
            <button class="tab-button" data-tab="analytics">Analytics</button>
            <button class="tab-button" data-tab="charts">Charts</button>
            <button class="tab-button" data-tab="logs">Logs</button>
            <button class="tab-button" data-tab="time-machine">‚è≥ Time Machine</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="dashboard-content">
        <div class="container">
            <!-- Broker Tab -->
            <div id="broker-tab" class="tab-content active">
                <h2>Broker Connection</h2>

                <div class="card">
                    <h3>Select Broker</h3>
                    <div id="broker-list" class="broker-grid">
                        <!-- Broker cards will be loaded here -->
                    </div>

                    <div id="change-broker-section" class="change-broker-section" style="display: none;">
                        <button type="button" id="change-broker-btn" class="btn btn-change-broker">Change
                            Broker</button>
                    </div>
                </div>

                <div id="credentials-section" class="card" style="display: none;">
                    <h3>Enter Credentials</h3>
                    <form id="credentials-form">
                        <!-- Dynamic form fields will be loaded here -->
                    </form>
                    <div class="form-actions">
                        <button type="button" id="connect-btn" class="btn btn-primary">Connect</button>
                    </div>
                </div>

                <div id="connection-status" class="card" style="display: none;">
                    <h3>Connection Status</h3>
                    <div id="connection-info" class="broker-status-display">
                        <!-- Connection info will be displayed here -->
                    </div>
                    <div class="form-actions">
                        <button type="button" id="test-connection-btn" class="btn btn-secondary">Test
                            Connection</button>
                        <button type="button" id="disconnect-btn" class="btn btn-danger">Disconnect</button>
                    </div>
                </div>
            </div>

            <!-- Instruments Tab -->
            <div id="instruments-tab" class="tab-content">
                <h2>Select Instruments</h2>

                <div class="card">
                    <div class="instruments-toolbar">
                        <input type="text" id="instrument-search" placeholder="Search instruments..."
                            class="search-input">
                        <div style="display: flex; gap: 0.5rem; align-items: center;">
                            <button id="refresh-instruments-btn" class="btn btn-secondary">
                                <span class="btn-icon">üîÑ</span> Refresh
                            </button>
                        </div>
                    </div>

                    <div class="filters">
                        <label>Exchange:</label>
                        <label><input type="checkbox" name="exchange" value="NSE"> NSE</label>
                        <label><input type="checkbox" name="exchange" value="BSE"> BSE</label>
                        <label><input type="checkbox" name="exchange" value="NFO"> NFO</label>

                        <label>Type:</label>
                        <label><input type="checkbox" name="type" value="EQ"> Equity</label>
                        <label><input type="checkbox" name="type" value="FUT"> Futures</label>
                        <label><input type="checkbox" name="type" value="CE"> Call</label>
                        <label><input type="checkbox" name="type" value="PE"> Put</label>

                        <button id="clear-filters-btn" class="btn btn-sm btn-secondary">Clear Filters</button>
                    </div>

                    <div id="active-filters" class="active-filters" style="display: none;">
                        <!-- Active filters will be displayed here -->
                    </div>

                    <div id="instruments-table-container">
                        <div id="instruments-loading" class="loading-indicator" style="display: none;">
                            <div class="spinner"></div>
                            <p>Loading instruments...</p>
                        </div>
                        <table id="instruments-table" class="data-table">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" id="select-all"></th>
                                    <th class="sortable" data-sort="symbol">Symbol <span class="sort-icon"></span></th>
                                    <th class="sortable" data-sort="name">Name <span class="sort-icon"></span></th>
                                    <th class="sortable" data-sort="exchange">Exchange <span class="sort-icon"></span>
                                    </th>
                                    <th class="sortable" data-sort="instrument_type">Type <span
                                            class="sort-icon"></span></th>
                                    <th class="sortable" data-sort="last_price">Price <span class="sort-icon"></span>
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="instruments-tbody">
                                <!-- Instruments will be loaded here -->
                            </tbody>
                        </table>
                    </div>

                    <div class="pagination">
                        <button id="prev-page" class="btn btn-sm">Previous</button>
                        <span id="page-info">Page 1</span>
                        <button id="next-page" class="btn btn-sm">Next</button>
                    </div>
                </div>

                <div class="card">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="margin: 0;">Selected Instruments (<span id="selected-count">0</span>)</h3>
                        <button id="clear-all-selections-btn" class="btn btn-sm btn-secondary"
                            style="display: none;">Clear All</button>
                    </div>
                    <div id="selected-instruments">
                        <p style="color: var(--text-muted); text-align: center; padding: 1rem;">No instruments selected
                        </p>
                    </div>
                    <button id="continue-to-config-btn" class="btn btn-primary" disabled>Continue to
                        Configuration</button>
                </div>
            </div>

            <!-- Configuration Tab -->
            <div id="configuration-tab" class="tab-content">
                <h2>Bot Configuration</h2>

                <!-- Configuration Actions Bar -->
                <div class="card config-actions-bar">
                    <div class="config-actions-left">
                        <select id="preset-selector" class="form-control" style="max-width: 300px;">
                            <option value="">-- Select Preset --</option>
                        </select>
                    </div>
                    <div class="config-actions-right">
                        <button id="save-config-btn" class="btn btn-primary">
                            <span class="btn-icon">üíæ</span> Save
                        </button>
                        <button id="load-config-btn" class="btn btn-secondary">
                            <span class="btn-icon">üìÇ</span> Load
                        </button>
                        <button id="export-config-btn" class="btn btn-secondary">
                            <span class="btn-icon">üì§</span> Export
                        </button>
                        <button id="import-config-btn" class="btn btn-secondary">
                            <span class="btn-icon">üì•</span> Import
                        </button>
                        <button id="copy-config-btn" class="btn btn-secondary">
                            <span class="btn-icon">üìã</span> Copy
                        </button>
                    </div>
                </div>

                <!-- Configuration Form Container -->
                <div class="card config-form-container">
                    <!-- Configuration Sub-Tabs -->
                    <div class="config-tabs">
                        <button class="config-tab-button active" data-config-tab="basic">
                            <span class="tab-icon">‚öôÔ∏è</span> Basic
                        </button>
                        <button class="config-tab-button" data-config-tab="strategy">
                            <span class="tab-icon">üìä</span> Strategy
                        </button>
                        <button class="config-tab-button" data-config-tab="risk">
                            <span class="tab-icon">üõ°Ô∏è</span> Risk
                        </button>
                        <button class="config-tab-button" data-config-tab="indicators">
                            <span class="tab-icon">üìà</span> Indicators
                        </button>
                        <button class="config-tab-button" data-config-tab="advanced">
                            <span class="tab-icon">üîß</span> Advanced
                        </button>
                    </div>

                    <!-- Configuration Form -->
                    <form id="config-form">
                        <!-- Basic Settings Section -->
                        <div class="config-section active" data-config-section="basic">
                            <h3 class="section-title">Basic Settings</h3>

                            <div class="form-group">
                                <label>Selected Instruments</label>
                                <div id="config-selected-instruments" class="selected-instruments-display">
                                    <p class="text-muted">No instruments selected. Go to Instruments tab to select.</p>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="config-timeframe">Timeframe</label>
                                <select id="config-timeframe" name="timeframe" class="form-control">
                                    <option value="1min">1 Minute</option>
                                    <option value="5min">5 Minutes</option>
                                    <option value="15min" selected>15 Minutes</option>
                                    <option value="30min">30 Minutes</option>
                                    <option value="1hour">1 Hour</option>
                                    <option value="1day">1 Day</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="config-strategy">Strategy</label>
                                <select id="config-strategy" name="strategy" class="form-control">
                                    <option value="trend_following" selected>Trend Following</option>
                                    <option value="momentum">Momentum</option>
                                    <option value="mean_reversion">Mean Reversion</option>
                                    <option value="breakout">Breakout</option>
                                    <option value="scalping">Scalping</option>
                                </select>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-trading-start">Trading Start Time</label>
                                    <input type="time" id="config-trading-start" name="trading_start"
                                        class="form-control" value="09:15">
                                </div>
                                <div class="form-group">
                                    <label for="config-trading-end">Trading End Time</label>
                                    <input type="time" id="config-trading-end" name="trading_end" class="form-control"
                                        value="15:30">
                                </div>
                            </div>
                        </div>

                        <!-- Strategy Parameters Section -->
                        <div class="config-section" id="strategy-parameters-section" data-config-section="strategy">
                            <h3 class="section-title">Strategy Parameters</h3>

                            <div class="form-group">
                                <label for="config-indicator-period">Indicator Period</label>
                                <input type="number" id="config-indicator-period" name="indicator_period"
                                    class="form-control" min="5" max="200" value="20">
                                <small class="form-help">Number of periods for indicator calculation</small>
                            </div>

                            <div class="form-group">
                                <label for="config-position-sizing">Position Sizing Method</label>
                                <select id="config-position-sizing" name="position_sizing" class="form-control">
                                    <option value="fixed" selected>Fixed Amount</option>
                                    <option value="percentage">Percentage of Capital</option>
                                    <option value="risk_based">Risk-Based</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="config-base-position-size">Base Position Size (‚Çπ)</label>
                                <input type="number" id="config-base-position-size" name="base_position_size"
                                    class="form-control" min="1000" step="1000" value="10000">
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-take-profit">Take Profit (%)</label>
                                    <input type="number" id="config-take-profit" name="take_profit" class="form-control"
                                        min="0.5" max="20" step="0.5" value="2.0">
                                </div>
                                <div class="form-group">
                                    <label for="config-stop-loss">Stop Loss (%)</label>
                                    <input type="number" id="config-stop-loss" name="stop_loss" class="form-control"
                                        min="0.5" max="10" step="0.1" value="1.0">
                                </div>
                            </div>

                            <hr>
                            <h4 class="sub-section-title">Moving Averages & ATR</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-fast-ma-period">Fast MA Period</label>
                                    <input type="number" id="config-fast-ma-period" name="fast_ma_period"
                                        class="form-control" min="2" max="100" value="10">
                                </div>
                                <div class="form-group">
                                    <label for="config-slow-ma-period">Slow MA Period</label>
                                    <input type="number" id="config-slow-ma-period" name="slow_ma_period"
                                        class="form-control" min="5" max="200" value="21">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-atr-period">ATR Period</label>
                                    <input type="number" id="config-atr-period" name="atr_period" class="form-control"
                                        min="2" max="50" value="14">
                                </div>
                                <div class="form-group">
                                    <label for="config-atr-multiplier">ATR Multiplier</label>
                                    <input type="number" id="config-atr-multiplier" name="atr_multiplier"
                                        class="form-control" min="0.1" max="10" step="0.1" value="2.0">
                                </div>
                            </div>
                        </div>

                        <!-- Risk Management Section -->
                        <div class="config-section" data-config-section="risk">
                            <h3 class="section-title">Risk Management</h3>

                            <div class="form-group">
                                <label for="config-risk-per-trade">Risk Per Trade (%)</label>
                                <div class="slider-input-group">
                                    <input type="range" id="config-risk-per-trade-slider" class="form-slider" min="0.1"
                                        max="10" step="0.1" value="1.0">
                                    <input type="number" id="config-risk-per-trade" name="risk_per_trade"
                                        class="form-control slider-number-input" min="0.1" max="10" step="0.1"
                                        value="1.0">
                                </div>
                                <small class="form-help">Maximum risk per trade as percentage of capital</small>
                            </div>

                            <div class="form-group">
                                <label for="config-max-positions">Max Concurrent Positions</label>
                                <input type="number" id="config-max-positions" name="max_positions" class="form-control"
                                    min="1" max="20" value="3">
                                <small class="form-help">Maximum number of positions open at the same time</small>
                            </div>

                            <hr>
                            <h4 class="sub-section-title">Trailing Stop Loss</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-trail-activation">Trail Activation (ATR)</label>
                                    <input type="number" id="config-trail-activation" name="trail_activation"
                                        class="form-control" min="0.1" max="10" step="0.1" value="1.5">
                                    <small class="form-help">When to start trailing (in ATR multiples)</small>
                                </div>
                                <div class="form-group">
                                    <label for="config-trail-distance">Trail Distance (ATR)</label>
                                    <input type="number" id="config-trail-distance" name="trail_distance"
                                        class="form-control" min="0.1" max="10" step="0.1" value="1.0">
                                    <small class="form-help">Distance to trail behind price</small>
                                </div>
                            </div>

                            <hr>
                            <h4 class="sub-section-title">Split Orders & Partial Profit</h4>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="config-use-split-orders" name="use_split_orders" checked>
                                    Use Split Orders
                                </label>
                                <small class="form-help">Split large orders into multiple positions for partial
                                    exit</small>
                            </div>
                            <div class="form-group">
                                <label for="config-num-positions">Number of Split Positions</label>
                                <input type="number" id="config-num-positions" name="num_positions" class="form-control"
                                    min="1" max="5" value="3">
                            </div>

                            <div class="form-group">
                                <label for="config-max-daily-loss">Max Daily Loss (%)</label>
                                <div class="slider-input-group">
                                    <input type="range" id="config-max-daily-loss-slider" class="form-slider" min="0.5"
                                        max="20" step="0.5" value="3.0">
                                    <input type="number" id="config-max-daily-loss" name="max_daily_loss"
                                        class="form-control slider-number-input" min="0.5" max="20" step="0.5"
                                        value="3.0">
                                </div>
                                <small class="form-help">Bot will stop trading if daily loss exceeds this limit</small>
                            </div>

                            <!-- Risk Metrics Panel -->
                            <div class="risk-metrics-panel">
                                <h4 class="metrics-title">Risk Metrics</h4>
                                <div class="metrics-grid">
                                    <div class="metric-item">
                                        <span class="metric-label">Risk Per Trade (‚Çπ)</span>
                                        <span class="metric-value" id="risk-amount-value">--</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Max Position Size (‚Çπ)</span>
                                        <span class="metric-value" id="max-position-value">--</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Total Risk Exposure (‚Çπ)</span>
                                        <span class="metric-value" id="total-risk-value">--</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Max Daily Loss (‚Çπ)</span>
                                        <span class="metric-value" id="max-daily-loss-value">--</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Capital Required</span>
                                        <span class="metric-value" id="capital-required-value">--</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Risk/Reward Ratio</span>
                                        <span class="metric-value" id="risk-reward-value">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Technical Indicators Section -->
                        <div class="config-section" data-config-section="indicators">
                            <h3 class="section-title">Technical Indicators & Loop</h3>

                            <div class="form-group">
                                <label for="config-loop-interval">Trading Loop Interval (seconds)</label>
                                <input type="number" id="config-loop-interval" name="loop_interval" class="form-control"
                                    min="1" max="300" value="5">
                                <small class="form-help">Seconds to wait between trading cycles (1 = Real-time)</small>
                            </div>

                            <hr>
                            <h4 class="sub-section-title">RSI (Relative Strength Index)</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-rsi-period">RSI Period</label>
                                    <input type="number" id="config-rsi-period" name="rsi_period" class="form-control"
                                        min="2" max="50" value="14">
                                </div>
                                <div class="form-group">
                                    <label for="config-rsi-overbought">Overbought</label>
                                    <input type="number" id="config-rsi-overbought" name="rsi_overbought"
                                        class="form-control" min="50" max="95" value="70">
                                </div>
                                <div class="form-group">
                                    <label for="config-rsi-oversold">Oversold</label>
                                    <input type="number" id="config-rsi-oversold" name="rsi_oversold"
                                        class="form-control" min="5" max="50" value="30">
                                </div>
                            </div>

                            <hr>
                            <h4 class="sub-section-title">MACD & Momentum</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-macd-min-histogram">Min MACD Histogram</label>
                                    <input type="number" id="config-macd-min-histogram" name="macd_min_histogram"
                                        class="form-control" step="0.0001" value="0.0005">
                                </div>
                                <div class="form-group">
                                    <label for="config-roc-threshold">ROC Threshold (%)</label>
                                    <input type="number" id="config-roc-threshold" name="roc_threshold"
                                        class="form-control" step="0.01" value="0.15">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-macd-fast">MACD Fast</label>
                                    <input type="number" id="config-macd-fast" name="macd_fast" class="form-control"
                                        min="2" max="50" value="12">
                                </div>
                                <div class="form-group">
                                    <label for="config-macd-slow">MACD Slow</label>
                                    <input type="number" id="config-macd-slow" name="macd_slow" class="form-control"
                                        min="5" max="100" value="26">
                                </div>
                                <div class="form-group">
                                    <label for="config-macd-signal">MACD Signal</label>
                                    <input type="number" id="config-macd-signal" name="macd_signal" class="form-control"
                                        min="2" max="20" value="9">
                                </div>
                            </div>

                            <hr>
                            <h4 class="sub-section-title">Trend Detection Engine</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-min-trend-confidence">Min Trend Confidence</label>
                                    <input type="number" id="config-min-trend-confidence" name="min_trend_confidence"
                                        class="form-control" min="0" max="1" step="0.05" value="0.6">
                                </div>
                                <div class="form-group">
                                    <label for="config-trend-sensitivity">Trend Sensitivity (1-10)</label>
                                    <input type="number" id="config-trend-sensitivity"
                                        name="trend_detection_sensitivity" class="form-control" min="1" max="10"
                                        value="5">
                                </div>
                            </div>

                            <hr>
                            <h4 class="sub-section-title">ADX (Trend Strength)</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="config-adx-period">ADX Period</label>
                                    <input type="number" id="config-adx-period" name="adx_period" class="form-control"
                                        min="2" max="50" value="14">
                                </div>
                                <div class="form-group">
                                    <label for="config-adx-min-strength">Min ADX Strength</label>
                                    <input type="number" id="config-adx-min-strength" name="adx_min_strength"
                                        class="form-control" min="0" max="100" value="25">
                                </div>
                            </div>
                        </div>

                        <!-- Advanced Settings Section -->
                        <div class="config-section" data-config-section="advanced">
                            <h3 class="section-title">Advanced Settings</h3>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="config-paper-trading" name="paper_trading">
                                    Enable Paper Trading
                                </label>
                                <small class="form-help">Test strategies without real money</small>
                            </div>

                            <div class="form-group">
                                <label for="config-paper-trading-initial-balance">Paper Trading Initial Balance
                                    (‚Çπ)</label>
                                <input type="number" id="config-paper-trading-initial-balance"
                                    name="paper_trading_initial_balance" class="form-control" min="10000"
                                    max="100000000" step="10000" value="5000000">
                                <small class="form-help">Simulated starting capital (default: ‚Çπ50,00,000)</small>
                            </div>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="config-allow-after-hours" name="allow_after_hours">
                                    Allow After-Hours Trading
                                </label>
                                <small class="form-help">Enable trading/testing even when market is closed (IST)</small>
                            </div>

                            <div class="form-group">
                                <label for="config-log-level">Log Level</label>
                                <select id="config-log-level" name="log_level" class="form-control">
                                    <option value="DEBUG">Debug</option>
                                    <option value="INFO" selected>Info</option>
                                    <option value="WARNING">Warning</option>
                                    <option value="ERROR">Error</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="config-data-refresh-interval">Data Refresh Interval (seconds)</label>
                                <input type="number" id="config-data-refresh-interval" name="data_refresh_interval"
                                    class="form-control" min="1" max="300" value="60">
                            </div>

                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="config-enable-notifications" name="enable_notifications">
                                    Enable Notifications
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Monitor Tab -->
            <div id="monitor-tab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 style="margin: 0;">Bot Monitor</h2>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <span id="last-updated-display" class="last-updated-text"
                            style="color: var(--text-muted); font-size: 0.9rem;"></span>
                        <button id="manual-refresh-btn" class="btn btn-secondary">
                            <span class="btn-icon">üîÑ</span> Refresh
                        </button>
                    </div>
                </div>

                <!-- Bot Status Card -->
                <div class="card bot-status-card">
                    <div class="bot-status-header">
                        <h3>Bot Status</h3>
                        <div class="bot-status-indicator" id="bot-status-indicator">
                            <span class="status-dot"></span>
                            <span class="status-text">Stopped</span>
                        </div>
                    </div>

                    <div class="bot-status-grid">
                        <div class="bot-status-item">
                            <div class="status-item-icon">ü§ñ</div>
                            <div class="status-item-content">
                                <div class="status-item-label">Bot Status</div>
                                <div class="status-item-value" id="bot-running-status">Stopped</div>
                            </div>
                        </div>

                        <div class="bot-status-item">
                            <div class="status-item-icon">‚è±Ô∏è</div>
                            <div class="status-item-content">
                                <div class="status-item-label">Uptime</div>
                                <div class="status-item-value" id="bot-uptime">--</div>
                            </div>
                        </div>

                        <div class="bot-status-item">
                            <div class="status-item-icon">üîó</div>
                            <div class="status-item-content">
                                <div class="status-item-label">Broker Connection</div>
                                <div class="status-item-value" id="bot-broker-status">Not Connected</div>
                            </div>
                        </div>

                        <div class="bot-status-item">
                            <div class="status-item-icon">üìä</div>
                            <div class="status-item-content">
                                <div class="status-item-label">Open Positions</div>
                                <div class="status-item-value" id="bot-positions-count">0</div>
                            </div>
                        </div>
                    </div>

                    <div class="bot-control-actions">
                        <button id="start-bot-btn" class="btn btn-success">
                            <span class="btn-icon">‚ñ∂Ô∏è</span> Start Bot
                        </button>
                        <button id="stop-bot-btn" class="btn btn-danger" style="display: none;">
                            <span class="btn-icon">‚èπÔ∏è</span> Stop Bot
                        </button>
                        <button id="restart-bot-btn" class="btn btn-warning" style="display: none;">
                            <span class="btn-icon">üîÑ</span> Restart Bot
                        </button>
                    </div>
                </div>

                <!-- Account Information Card -->
                <div class="card account-info-card">
                    <div class="account-info-header">
                        <h3>Account Information</h3>
                        <div class="account-refresh-indicator" id="account-refresh-indicator">
                            <span class="refresh-icon">üîÑ</span>
                            <span class="refresh-text">Auto-refresh: 5s</span>
                        </div>
                    </div>

                    <div class="account-info-grid">
                        <div class="account-info-item">
                            <div class="account-item-icon">üí∞</div>
                            <div class="account-item-content">
                                <div class="account-item-label">Balance</div>
                                <div class="account-item-value" id="account-balance">--</div>
                            </div>
                        </div>

                        <div class="account-info-item">
                            <div class="account-item-icon">üìä</div>
                            <div class="account-item-content">
                                <div class="account-item-label">Equity</div>
                                <div class="account-item-value" id="account-equity">--</div>
                            </div>
                        </div>

                        <div class="account-info-item">
                            <div class="account-item-icon">‚úÖ</div>
                            <div class="account-item-content">
                                <div class="account-item-label">Available Margin</div>
                                <div class="account-item-value" id="account-margin-available">--</div>
                            </div>
                        </div>

                        <div class="account-info-item">
                            <div class="account-item-icon">‚ö†Ô∏è</div>
                            <div class="account-item-content">
                                <div class="account-item-label">Used Margin</div>
                                <div class="account-item-value" id="account-margin-used">--</div>
                            </div>
                        </div>

                        <div class="account-info-item account-pnl-item">
                            <div class="account-item-icon">üìà</div>
                            <div class="account-item-content">
                                <div class="account-item-label">Today's P&L</div>
                                <div class="account-item-value" id="account-pnl-today">--</div>
                            </div>
                        </div>
                    </div>

                    <div class="account-info-footer">
                        <div class="account-status-message" id="account-status-message">
                            <span class="status-icon">‚ÑπÔ∏è</span>
                            <span class="status-text">Connect to broker to view account information</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>Open Positions</h3>
                    <table id="positions-table" class="data-table">
                        <thead>
                            <tr>
                                <th>Symbol</th>
                                <th>Quantity</th>
                                <th>Entry Price</th>
                                <th>Current Price</th>
                                <th>P&L</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="positions-tbody">
                            <!-- Positions will be loaded here -->
                        </tbody>
                    </table>
                </div>

                <!-- Activity Log Card -->
                <div class="activity-log-card" id="activity-log-container">
                    <div class="activity-log-header">
                        <div class="activity-log-title">
                            <span>üìã</span>
                            <span>Live Activity Log</span>
                            <span class="activity-count">0</span>
                        </div>
                        <div class="activity-log-controls">
                            <button class="clear-activities-btn">Clear</button>
                        </div>
                    </div>

                    <div class="activity-filter-bar">
                        <button class="filter-btn" data-type="analysis">üìä Analysis</button>
                        <button class="filter-btn" data-type="signal">‚ö° Signals</button>
                        <button class="filter-btn" data-type="order">‚úÖ Orders</button>
                        <button class="filter-btn" data-type="position">üìà Positions</button>
                        <button class="filter-btn" data-type="warning">‚ö†Ô∏è Warnings</button>
                        <button class="filter-btn" data-type="error">‚ùå Errors</button>
                    </div>

                    <div class="activity-log-content">
                        <div class="no-activities">No activities yet. Start the bot to see live updates.</div>
                    </div>
                </div>
            </div>

            <!-- Trades Tab -->
            <div id="trades-tab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="margin: 0;">Trade History</h2>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-secondary" onclick="TradeHistory.exportToCSV()" title="Export to CSV">üìä
                            Export CSV</button>
                        <button class="btn btn-secondary" onclick="TradeHistory.exportToExcel()"
                            title="Export to Excel">üìà Export Excel</button>
                    </div>
                </div>

                <div class="card">
                    <div class="filters">
                        <label>From:</label>
                        <input type="date" id="from-date" class="form-control">
                        <label>To:</label>
                        <input type="date" id="to-date" class="form-control">
                        <button id="filter-trades-btn" class="btn btn-secondary">Filter</button>
                    </div>
                    <div class="quick-filters">
                        <label>Quick Filters:</label>
                        <button id="filter-today-btn" class="btn btn-sm btn-quick-filter">Today</button>
                        <button id="filter-week-btn" class="btn btn-sm btn-quick-filter">This Week</button>
                        <button id="filter-month-btn" class="btn btn-sm btn-quick-filter">This Month</button>
                        <button id="filter-clear-btn" class="btn btn-sm btn-secondary">Clear</button>
                    </div>
                </div>

                <!-- Trade Statistics Card -->
                <div class="card" id="trade-statistics-card">
                    <h3>Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">Total Trades</div>
                            <div class="stat-value" id="stat-total-trades">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Win Rate</div>
                            <div class="stat-value" id="stat-win-rate">0%</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Total P&L</div>
                            <div class="stat-value" id="stat-total-pnl">‚Çπ0.00</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Avg P&L per Trade</div>
                            <div class="stat-value" id="stat-avg-pnl">‚Çπ0.00</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <table id="trades-table" class="data-table">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="timestamp">Date <span class="sort-icon"></span></th>
                                <th class="sortable" data-sort="symbol">Symbol <span class="sort-icon"></span></th>
                                <th class="sortable" data-sort="transaction_type">Type <span class="sort-icon"></span>
                                </th>
                                <th class="sortable" data-sort="quantity">Qty <span class="sort-icon"></span></th>
                                <th class="sortable" data-sort="price">Entry <span class="sort-icon"></span></th>
                                <th class="sortable" data-sort="exit_price">Exit <span class="sort-icon"></span></th>
                                <th class="sortable" data-sort="pnl">P&L <span class="sort-icon"></span></th>
                            </tr>
                        </thead>
                        <tbody id="trades-tbody">
                            <!-- Trades will be loaded here -->
                        </tbody>
                    </table>

                    <div class="pagination">
                        <button id="trades-prev-page" class="btn btn-sm">Previous</button>
                        <span id="trades-page-info">Page 1</span>
                        <button id="trades-next-page" class="btn btn-sm">Next</button>
                    </div>
                </div>
            </div>

            <!-- Charts Tab -->
            <div id="charts-tab" class="tab-content">
                <!-- Chart Controls Bar -->
                <div class="chart-controls-bar">
                    <!-- Symbol Selector -->
                    <div class="chart-control-group">
                        <label class="chart-control-label">Symbol:</label>
                        <select id="chart-symbol-selector">
                            <option value="">-- Select Symbol --</option>
                        </select>
                    </div>

                    <!-- Timeframe Selector -->
                    <div class="chart-control-group">
                        <label class="chart-control-label">Timeframe:</label>
                        <div class="timeframe-buttons">
                            <button class="timeframe-btn" data-timeframe="1min">1m</button>
                            <button class="timeframe-btn" data-timeframe="5min">5m</button>
                            <button class="timeframe-btn" data-timeframe="15min">15m</button>
                            <button class="timeframe-btn" data-timeframe="30min">30m</button>
                            <button class="timeframe-btn" data-timeframe="1hour">1h</button>
                            <button class="timeframe-btn" data-timeframe="1day">1D</button>
                        </div>
                    </div>

                    <!-- Indicator Toggles -->
                    <div class="chart-control-group">
                        <label class="chart-control-label">Indicators:</label>
                        <div id="indicator-toggles" class="indicator-toggles">
                            <!-- Indicator buttons will be added here by JavaScript -->
                        </div>
                    </div>

                    <!-- Refresh Button -->
                    <button id="chart-refresh-btn">
                        <span>üîÑ</span>
                        <span>Refresh</span>
                    </button>
                </div>

                <!-- Main Chart Container -->
                <div class="chart-main-container">
                    <!-- Price Chart -->
                    <div class="price-chart-wrapper">
                        <div id="price-chart-container">
                            <!-- Chart will be rendered here -->
                            <div class="chart-empty-state">
                                <div class="chart-empty-state-icon">üìä</div>
                                <div class="chart-empty-state-text">Select a symbol to view chart</div>
                                <div class="chart-empty-state-subtext">Choose from your selected instruments above</div>
                            </div>
                        </div>

                        <!-- Loading Indicator -->
                        <div id="chart-loading">
                            <div class="spinner"></div>
                        </div>

                        <!-- Trade Markers Legend -->
                        <div class="trade-markers-legend">
                            <div class="trade-marker-item">
                                <span class="trade-marker-icon trade-marker-buy">‚ñ≤</span>
                                <span>Buy Entry</span>
                            </div>
                            <div class="trade-marker-item">
                                <span class="trade-marker-icon trade-marker-sell">‚ñº</span>
                                <span>Sell Entry</span>
                            </div>
                            <div class="trade-marker-item">
                                <span class="trade-marker-icon trade-marker-exit">‚óè</span>
                                <span>Exit</span>
                            </div>
                        </div>
                    </div>

                    <!-- Indicator Panels (MACD, RSI, ATR) -->
                    <div id="indicator-panels" class="indicator-panels">
                        <!-- Indicator panels will be added here dynamically -->
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics-tab" class="tab-content">
                <!-- Loading Indicator -->
                <div id="analytics-loading" class="analytics-loading">
                    <div class="spinner"></div>
                </div>

                <!-- Date Range Controls -->
                <div class="analytics-controls">
                    <label>From:</label>
                    <input type="date" id="analytics-from-date">

                    <label>To:</label>
                    <input type="date" id="analytics-to-date">

                    <button id="analytics-apply-date" class="primary">Apply</button>
                    <button id="analytics-reset-date">Reset</button>
                </div>

                <div class="quick-filters">
                    <button id="analytics-filter-today">Today</button>
                    <button id="analytics-filter-week">Last 7 Days</button>
                    <button id="analytics-filter-month">Last 30 Days</button>
                </div>

                <!-- Performance Metrics -->
                <div class="performance-metrics">
                    <div class="metric-card">
                        <div class="metric-label">Total Trades</div>
                        <div class="metric-value" id="metric-total-trades">0</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Win Rate</div>
                        <div class="metric-value" id="metric-win-rate">0%</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Total P&L</div>
                        <div class="metric-value" id="metric-total-pnl">‚Çπ0.00</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Avg Trade</div>
                        <div class="metric-value" id="metric-avg-trade">‚Çπ0.00</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Profit Factor</div>
                        <div class="metric-value" id="metric-profit-factor">0.00</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Largest Win</div>
                        <div class="metric-value" id="metric-largest-win">‚Çπ0.00</div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-label">Largest Loss</div>
                        <div class="metric-value" id="metric-largest-loss">‚Çπ0.00</div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="charts-grid">
                    <!-- Profit by Symbol Chart -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Profit by Symbol</div>
                                <div class="chart-subtitle">P&L breakdown by trading symbol</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="profit-by-symbol-chart"></canvas>
                        </div>
                    </div>

                    <!-- Win/Loss by Symbol Chart -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Win/Loss by Symbol</div>
                                <div class="chart-subtitle">Winning and losing trades per symbol</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="win-loss-chart"></canvas>
                        </div>
                    </div>

                    <!-- Daily Profit Chart -->
                    <div class="chart-card full-width">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Daily Profit Trend</div>
                                <div class="chart-subtitle">Cumulative P&L over time</div>
                            </div>
                        </div>
                        <div class="chart-container tall">
                            <canvas id="daily-profit-chart"></canvas>
                        </div>
                    </div>

                    <!-- Hourly Performance Chart -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Hourly Performance</div>
                                <div class="chart-subtitle">P&L by hour of day</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="hourly-performance-chart"></canvas>
                        </div>
                    </div>

                    <!-- Trade Distribution Chart -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Trade Distribution</div>
                                <div class="chart-subtitle">Trade count by symbol</div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="trade-distribution-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Logs Tab -->
            <div id="logs-tab" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                    <h2 style="margin: 0;">System Logs</h2>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <button id="logs-refresh-btn" class="btn btn-secondary">
                            <span class="btn-icon">üîÑ</span> Refresh
                        </button>
                        <button id="logs-download-btn" class="btn btn-primary">
                            <span class="btn-icon">üì•</span> Download CSV
                        </button>
                        <button id="logs-clear-btn" class="btn btn-danger">
                            <span class="btn-icon">üóëÔ∏è</span> Clear Logs
                        </button>
                    </div>
                </div>

                <!-- Logs Control Bar -->
                <div class="card logs-control-bar">
                    <div class="logs-control-group">
                        <label for="log-level-filter">Display Level:</label>
                        <select id="log-level-filter" class="form-control">
                            <option value="">All Levels</option>
                            <option value="DEBUG">DEBUG</option>
                            <option value="INFO" selected>INFO</option>
                            <option value="WARNING">WARNING</option>
                            <option value="ERROR">ERROR</option>
                            <option value="CRITICAL">CRITICAL</option>
                        </select>
                    </div>

                    <div class="logs-control-group">
                        <label for="log-search">Search:</label>
                        <input type="text" id="log-search" class="form-control"
                            placeholder="Search message or logger...">
                    </div>

                    <div class="logs-control-group">
                        <label for="log-global-level">Bot Logging Level:</label>
                        <select id="log-global-level" class="form-control">
                            <option value="DEBUG">DEBUG (Detailed)</option>
                            <option value="INFO" selected>INFO (Standard)</option>
                            <option value="WARNING">WARNING (Only Alerts)</option>
                            <option value="ERROR">ERROR (Only Failures)</option>
                        </select>
                        <button id="apply-global-level-btn" class="btn btn-sm btn-secondary">Apply</button>
                    </div>
                </div>

                <!-- Logs Table -->
                <div class="card logs-table-container">
                    <div id="logs-loading" class="loading-indicator" style="display: none;">
                        <div class="spinner"></div>
                        <p>Fetching logs...</p>
                    </div>
                    <table id="logs-table" class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 180px;">Timestamp</th>
                                <th style="width: 100px;">Level</th>
                                <th style="width: 150px;">Logger</th>
                                <th>Message</th>
                                <th style="width: 100px;">Symbol</th>
                            </tr>
                        </thead>
                        <tbody id="logs-tbody">
                            <!-- Logs will be loaded here -->
                        </tbody>
                    </table>

                    <div class="pagination">
                        <button id="logs-prev-page" class="btn btn-sm">Previous</button>
                        <span id="logs-page-info">Page 1 of 1 (0 logs)</span>
                        <button id="logs-next-page" class="btn btn-sm">Next</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================================ -->
        <!-- TIME MACHINE TAB                                             -->
        <!-- ============================================================ -->
        <div id="time-machine-tab" class="tab-content">
            <div class="d-flex align-items-center justify-content-between mb-3">
                <h2 class="mb-0">‚è≥ Time Machine</h2>
                <small class="text-muted">Test your strategy in the past or the future</small>
            </div>

            <!-- Sub-tab switcher -->
            <div class="tm-subtab-bar mb-3">
                <button class="tm-subtab active" data-mode="backtest">üìÖ Backtest (Past)</button>
                <button class="tm-subtab" data-mode="forward">üîÆ Forward Test (Future)</button>
            </div>

            <div id="tm-alert" class="alert" style="display:none;"></div>
            <p id="tm-mode-hint" class="text-muted small mb-3">üìÖ Backtest runs on historical data. Kite connection
                required for real data; falls back to simulated data otherwise.</p>

            <!-- Run Configuration -->
            <div class="card tm-card">
                <h5 class="mb-3">‚öôÔ∏è Run Configuration</h5>
                <div class="row g-3">

                    <!-- Run name -->
                    <div class="col-md-4">
                        <label class="form-label">Run Name</label>
                        <input id="tm-run-name" class="form-control" type="text" placeholder="My Strategy Test">
                    </div>

                    <!-- From date -->
                    <div class="col-md-2" id="tm-from-date-group">
                        <label class="form-label">From Date</label>
                        <input id="tm-from-date" class="form-control" type="date">
                    </div>

                    <!-- To date -->
                    <div class="col-md-2" id="tm-to-date-group">
                        <label class="form-label">To Date</label>
                        <input id="tm-to-date" class="form-control" type="date">
                    </div>

                    <!-- Capital -->
                    <div class="col-md-2">
                        <label class="form-label">Capital (‚Çπ)</label>
                        <input id="tm-capital" class="form-control" type="number" value="500000" min="10000"
                            step="10000">
                    </div>

                    <!-- Timeframe preset -->
                    <div class="col-md-2">
                        <label class="form-label">Timeframe</label>
                        <select id="tm-preset" class="form-select">
                            <option value="1min">1 Min</option>
                            <option value="5min">5 Min</option>
                            <option value="15min" selected>15 Min</option>
                            <option value="30min">30 Min</option>
                            <option value="60min">1 Hour</option>
                            <option value="day">Daily</option>
                        </select>
                    </div>

                    <!-- Symbols -->
                    <div class="col-12">
                        <label class="form-label">Symbols <small class="text-muted">(type + Enter to
                                add)</small></label>
                        <div class="tm-symbol-input-wrap">
                            <div id="tm-symbol-tags" class="tm-tags-container"></div>
                            <input id="tm-symbol-input" class="tm-symbol-bare-input" type="text"
                                placeholder="e.g. RELIANCE, TCS, NIFTY‚Ä¶">
                        </div>
                        <small class="text-muted">Suggested: RELIANCE &bull; TCS &bull; INFY &bull; HDFCBANK &bull;
                            NIFTY &bull; BANKNIFTY</small>
                    </div>

                    <!-- Config override -->
                    <div class="col-12">
                        <label class="form-label">Config Override <small class="text-muted">(optional JSON, e.g.
                                {"stop_loss":1.0, "take_profit":2.0})</small></label>
                        <textarea id="tm-config-override" class="form-control font-monospace" rows="2"
                            placeholder='{"stop_loss":0.75,"take_profit":1.5,"risk_per_trade":1.0}'></textarea>
                    </div>

                    <!-- Progress -->
                    <div class="col-12" id="tm-progress-wrap" style="display:none;">
                        <div class="progress" style="height:22px">
                            <div id="tm-progress-bar" class="progress-bar progress-bar-striped progress-bar-animated"
                                style="width:0%">0%</div>
                        </div>
                    </div>

                    <!-- Run button -->
                    <div class="col-12 d-flex justify-content-end">
                        <button id="tm-run-btn" class="btn btn-primary px-4">‚ñ∂ Run</button>
                    </div>
                </div>
            </div>

            <!-- Past results table -->
            <div class="card tm-card mt-3">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <h5 class="mb-0">üìã Results</h5>
                    <button class="btn btn-sm btn-outline-secondary" onclick="TimeMachine.loadResultsList()">üîÑ
                        Refresh</button>
                </div>
                <div class="table-responsive">
                    <table class="table table-sm table-hover mb-0">
                        <thead class="table-dark">
                            <tr>
                                <th>Date</th>
                                <th>Name</th>
                                <th>Symbols</th>
                                <th>Return</th>
                                <th>Max DD</th>
                                <th>Win%</th>
                                <th>Sharpe</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tm-results-tbody">
                            <tr>
                                <td colspan="9" class="text-muted text-center py-3">No results yet.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Detail panel (hidden until a run is clicked) -->
            <div id="tm-detail-panel" class="mt-3" style="display:none;"></div>

        </div><!-- end time-machine-tab -->

        </div>
    </main>

    <!-- Footer -->
    <footer class="dashboard-footer">
        <div class="container">
            <p>&copy; 2024 Indian Market Trading Dashboard</p>
        </div>
    </footer>

    <!-- Notification Container -->
    <div id="notification-container"></div>

    <!-- Scripts -->
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/loading-states.js"></script>
    <script src="/static/js/error-handler.js"></script>
    <script src="/static/js/session-manager.js"></script>
    <!-- API Client -->
    <script src="/static/js/api-client.js"></script>
    <script src="/static/js/state.js"></script>
    <script src="/static/js/credentials-form.js"></script>
    <script src="/static/js/validation.js"></script>
    <script src="/static/js/presets.js"></script>
    <script src="/static/js/config-form.js"></script>
    <script src="/static/js/config-manager.js"></script>
    <script src="/static/js/export-import.js"></script>
    <script src="/static/js/strategy-parameters.js"></script>
    <script src="/static/js/strategy-recommendations.js"></script>
    <script src="/static/js/activity-log.js"></script>
    <script src="/static/js/risk-management.js"></script>
    <script src="/static/js/trades.js"></script>
    <!-- Chart.js for Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- TradingView Lightweight Charts for Price Charts -->
    <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
    <!-- Analytics -->
    <script src="/static/js/analytics-charts.js"></script>
    <script src="/static/js/analytics.js"></script>
    <!-- Charts -->
    <script src="/static/js/price-chart.js"></script>
    <script src="/static/js/chart-controls.js"></script>
    <script src="/static/js/logs.js"></script>
    <script src="/static/js/app.js"></script>
    <!-- UI/UX Enhancements -->
    <script src="/static/js/ui-enhancements.js"></script>
    <!-- Helpful Features -->
    <script src="/static/js/helpful-features.js"></script>
    <!-- Time Machine (Backtest + Forward Test) -->
    <script src="/static/js/backtest.js"></script>
    <script>
        // Init Time Machine when the tab is first opened
        document.querySelectorAll('.tab-button[data-tab="time-machine"]').forEach(btn => {
            btn.addEventListener('click', function onceInit() {
                TimeMachine.init();
                btn.removeEventListener('click', onceInit);
            });
        });
    </script>


</body>

</html>